<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Chema Guerra" /><!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="/favicon.png">
    <!-- MathJax -->
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Open Graph cards -->
    <meta property="og:url" content="http://0.0.0.0:4000/2023/09/07/principal-component-analysis.html">
    <meta property="og:title" content="Principal Component Analysis">
    <meta property="og:description" content="A walk through the fundamentals of PCA.">
    <meta property="og:image" content="http://0.0.0.0:4000/thumbnails/2023/chemaguerra-principal-component-analysis.png">
    <meta property="og:type" content="article">
    <!-- Twitter cards -->
    <meta name="twitter:site" content="@chemaguerra">
    <meta name="twitter:creator" content="@">
    <meta name="twitter:title" content="Principal Component Analysis">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="A walk through the fundamentals of PCA.">
    <meta name="twitter:image" content="http://0.0.0.0:4000/thumbnails/2023/chemaguerra-principal-component-analysis.png">
    <meta name="twitter:image:src" content="http://0.0.0.0:4000/thumbnails/2023/chemaguerra-principal-component-analysis.png">
    
    <!-- Make post images clickable to enlarge -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Find all images in post content and page content.
      var images = document.querySelectorAll('.post-content img, .page-content img');
      
      images.forEach(function(img) {
        // Skip if already wrapped in a link.
        if (img.parentElement.tagName === 'A') return;
        
        // Create link wrapper.
        var link = document.createElement('a');
        link.href = img.src;
        link.target = '_blank';
        link.title = 'Click to enlarge';
        
        // Wrap image with link.
        img.parentNode.insertBefore(link, img);
        link.appendChild(img);
        
        // Add cursor style.
        img.style.cursor = 'zoom-in';
      });
      
      // Make all external links open in new tab.
      var links = document.querySelectorAll('.post-content a, .page-content a');
      links.forEach(function(link) {
        // Check if link is external (not same domain).
        if (link.hostname && link.hostname !== window.location.hostname) {
          link.target = '_blank';
          link.rel = 'noopener noreferrer';
        }
      });
    });
    </script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chema Guerra</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/archive/">Archive</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Principal Component Analysis</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-09-07T10:58:40+02:00" itemprop="datePublished">Sep 7, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a> is a <em>data transformation</em> technique.</p>

<p>Given an n-dimensional set of data points, it finds an n-dimensional orthonormal basis where our data points can hopefully be seen……..</p>

<p>Besides computing the n basis axes, PCA also computes n values which tell how much of the total variance in the dataset is captured by each axis.</p>

<p>EXTEND</p>

<h2 id="example-2d-dataset">Example 2D dataset</h2>

<p>To illustrate this post we will be using a 2D dataset made of 1024 points uniformly distributed in the shape of an ellipse of radii \(a=1\) and \(b=.25\). The ellipse is centered at \((.5,.5)\) and tilted by \(\frac{\pi}{6}\) radians.</p>

<p><img src="/uploads/2023/chemaguerra-pca-dataset.png" alt="PCA example dataset" /></p>

<h2 id="simple-linear-regression">Simple Linear Regression</h2>

<p>First, let’s detour a little to talk about <a href="https://en.wikipedia.org/wiki/Simple_linear_regression">Simple Linear Regression</a>, which is a basic method one can use to approximate a set of 2D data points with a <em>best fitting line</em>.</p>

<p>It is common practice to define the best fitting line using <a href="https://en.wikipedia.org/wiki/Ordinary_least_squares">ordinary least squares</a>. <em>i.e.,</em> the line that minimizes the sum of vertical distances between itself and the points in the dataset.</p>

<p>I hope that the below video depicts this idea clearly:</p>

<video controls="controls" playsinline="playsinline" loop="" src="/uploads/2023/chemaguerra-slr-ellipse-512.mp4" width="512" height="512" poster="/uploads/2023/chemaguerra-slr-ellipse-512-poster.png" alt="Linear Regression" preload="none"></video>

<p>The vertical distances (also called <em>residuals</em>) are in yellow. As the best fitting line candidate (in white) rotates the plot at the bottom represents the OLS sum. It can be seen that the sum goes to infinity when the line is vertical, but reaches a minimum when the line is <em>as tilted as</em> the dataset.</p>

\[\begin{align}
\widehat\beta&amp;=\frac{\sum_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i=1}^n(x_i-\bar{x})(x_i-\bar{x})} \\
\widehat\alpha&amp;=\bar{y}-\widehat\beta{\bar{x}}
\end{align}\]

<p>In our dataset these calculate to \(\widehat\alpha=.238\ldots\) and \(\widehat\beta=.523\ldots\) which we can plug in the line equation:</p>

\[y=\widehat\alpha+\widehat\beta{x}\]

<p>\(.523\ldots=\widehat\beta\simeq tan(\frac{\pi}{6})=.577\ldots\) which means that the slope of the best fitting line is about \(\frac{\pi}{6}\) radians, like our dataset. All good.</p>

<p><img src="/uploads/2023/chemaguerra-slr-ellipse-result.png" alt="SLR result" /></p>

<p>The point of this detour is to introduce SLR as a basic intuitive method to capture some meaningful feature of an arbitrary dataset using a much simpler instrument such as a line.</p>

<h2 id="principal-component-analysis">Principal Component Analysis</h2>

<video controls="controls" playsinline="playsinline" loop="" src="/uploads/2023/chemaguerra-pca-ellipse-512.mp4" width="512" height="512" poster="/uploads/2023/chemaguerra-pca-ellipse-512-poster.png" alt="Linear Regression" preload="none"></video>

<p><img src="/uploads/2023/chemaguerra-pca-ellipse-result.png" alt="PCA result" /></p>

<p>EXTEND ALGORITHM</p>

<h2 id="pca-in-a-3d-point-cloud">PCA in a 3D point cloud</h2>

<p>EXTEND</p>

<h2 id="practical-uses-of-pca">Practical uses of PCA</h2>

<p>Most of the time, PCA is used as a preceding step to <em>data reduction</em>. Since PCA provides a set of axes where the dataset projections are sorted in decreasing order of variance, you can say that the amount of information provided by each new axes is less and less.</p>

<p>Actually, you may drop some of the trailing axes and obtain a <em>dimensionally-reduced</em> (and hence more tractable) version of your dataset that roughly captures the same amount of information as the original dataset.</p>

<h2 id="data-visualization">Data visualization</h2>

<p>A classic use is to drop all dimensions but the first two or three in order to plot the dataset in 2D or 3D. With a little luck, a heavy multi-dimensional dataset will exhibit some sort of obvious clustering you can make sense of when drawn on screen.</p>

<p>EXTEND WITH THE NUMBERS</p>

<h2 id="machine-learning">Machine Learning</h2>

<p>For ML, clustering, … it makes sense to run PCA on your data first. Then drop as many trailing principal components while still preserving the maximum amount of information (<em>e.g.</em> setting a cutoff at 99%). And from that moment on, work with the dimensionally-reduced dataset.</p>

<p>EXTEND WITH THE NUMBERS</p>

<h2 id="physics">Physics</h2>

<p>There is a beautiful relationship between the PCA of a set of points (interpreted as masses) and the tensor of inertia of said masses.</p>

<p>EXTEND</p>

<p>an axis of rotation is a principal axis, angular momentum and angular velocity are parallel, complex conjugate, importance analysis</p>

<p>EXTEND</p>

<h2 id="pca-implemented-in-eigen">PCA implemented in Eigen</h2>

<p>This is the implementation of PCA I am using in my code since I decided to replace some legacy implementations of numerical algorithms by Eigen.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Eigen::MatrixXd M;

M_to_E( m_M, __out__ M );  // Initialize M with the dataset.

const Eigen::VectorXd mean = M.colwise().mean();

M.rowwise() -= mean.transpose();

const Eigen::MatrixXd cov  = ( ( M.transpose() * M ) / ( M.rows() - 1 ) );

const Eigen::SelfAdjointEigenSolver&lt; Eigen::MatrixXd &gt; solver( cov );

if ( solver.info() == Eigen::Success )
{
  E_to_M( solver.eigenvalues (), __out__ m_E );  // Collect the solver's result.
  E_to_M( solver.eigenvectors(), __out__ m_V );	 //
}
</code></pre></div></div>

<h2 id="youtube-videos">YouTube videos</h2>

<div class="embed-container">
  <iframe width="640" height="390" src="https://www.youtube.com/embed/-xUIXzI2GY0" frameborder="0" allowfullscreen=""></iframe>
</div>
<style>
.embed-container {
  position: relative;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  max-width: 100%;
}
.embed-container iframe,
.embed-container object,
.embed-container embed {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
</style>

<div class="embed-container">
  <iframe width="640" height="390" src="https://www.youtube.com/embed/xwusOZXPAWk" frameborder="0" allowfullscreen=""></iframe>
</div>
<style>
.embed-container {
  position: relative;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  max-width: 100%;
}
.embed-container iframe,
.embed-container object,
.embed-container embed {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
</style>

<p><br />
PCA is very well documented on the Internet:</p>

<ul>
  <li>A great video by <a href="https://www.youtube.com/watch?v=TJdH6rPA-TI">Computerphile on PCA</a>.</li>
</ul>

  </div><a class="u-url" href="/2023/09/07/principal-component-analysis.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <h2 class="footer-heading">Chema Guerra</h2>
        <ul class="contact-list">
          <li class="p-name"><a class="u-email" href="mailto:brashandplucky@gmail.com">brashandplucky@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list">
  <li>
    <a href="https://x.com/chemaguerra">
      <svg class="svg-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" fill="currentColor"/>
      </svg>
      <span class="username">@chemaguerra</span>
    </a>
  </li>
  <li>
    <a href="https://x.com/topotoylabs">
      <svg class="svg-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" fill="currentColor"/>
      </svg>
      <span class="username">@topotoylabs</span>
    </a>
  </li>
</ul></div>

      <div class="footer-col footer-col-3">
        <p>This is a coding blog where I post about the various projects that I am currently working on, both at work, or as an independent researcher. Most content here revolves around computer graphics and physics simulation.</p>
      </div>
    </div>

  </div>

</footer></body>

</html>
